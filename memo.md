# Docker + VSCode + DevContainers プレゼン

## 構成

1. 現状の課題
   1. 環境差異によるトラブル
   2. 環境構築の無駄
2. 解決策(Docker + VSCode + DevContainers)
3. Before After
   1. 環境差異によるトラブル(具体的な解決策)
   2. 環境構築の無駄(現行 vs 解決策)
4. 解決策の懸念点と対策
5. まとめ

## 現状の課題

1. 環境差異によるトラブル

   1. バージョン差異
      (OS: Linux Distribution / Runtime: Java, Python / Tool: Git)
   2. 設定差異による成果物のブレ
      (文字コード / 改行コード / 整形設定)
   3. 再現性の欠如
      (ローカルデータ差異 / 環境リセットが困難 / 原因特定が難しい)
   4. 使用ポート競合
      (ユーザー差異 / 既存環境の影響)
   5. 本番環境との差異
      (Linux 環境の用意が手間 / フォルダ構成を再現できない)

2. 環境構築の無駄

   1. 手順書
      (準備が煩雑 / 更新されない / 属人化)
   2. 工数
      (新規参加 / 引き継ぎ / サポートに時間が取られる)
   3. トラブル
      (手順ミス / 既存環境の影響によるやり直し)

## Before/After 課題かつシーン

### 環境差異によるトラブル

#### When: エラー発生から復旧

- Before

  1. エラー発生
  2. 要因切り分けのための調査  
     （例：設定確認、他作業者への確認・比較）
  3. 環境要因の場合、手作業で復旧
  4. その他の要因の調査

- After：**環境要因を即切り分け、短時間で復旧可能**

  1. エラー発生
  2. 要因切り分けのためにコンテナを再構築
  3. 環境要因の場合は、コンテナ再構築のみで復旧
  4. その他の要因の調査

---

#### When: 本番差異による不具合検知

- Before

  1. Windows 環境で Linux 上で動作する Web アプリを構築
  2. 本番リリース
  3. Linux 特有の不具合が発生する可能性あり  
     （例：パス指定、ファイル権限 など）

- After：**本番差異による不具合を事前に検知**

  1. Docker の Linux 環境で Web アプリを構築
  2. 本番リリース
  3. Linux 特有の不具合が発生しにくい構成

---

### 環境構築の無駄やリスク

#### When: 初回構築から環境変更の適用

（環境変更例：Runtime バージョン変更、DB スキーマ変更）

- Before

  1. 手順書を作成し配布
  2. 各自が手作業で環境構築  
     （時間がかかる,手作業によるミス）
  3. 環境変更が発生
  4. 手順書を修正して再配布  
     （更新漏れ,手作業ミス）
  5. 各自が手作業で変更を適用

- After：**環境変更を安全かつ確実に反映可能**

  1. Docker + VSCode + DevContainers の導入手順を実施
  2. 環境定義ファイルを作成し、資材と共に Git 管理
  3. 各自が Git から資材を取得し、VSCode でコンテナ起動
  4. 環境変更が発生
  5. 環境定義ファイルを修正して Git に反映
  6. 各自が最新資材を取得し、コンテナを再構築

---

#### When: 作業者追加と担当変更

- Before

  1. 作業者追加
  2. 資材を Git から取得
  3. 手順書を参照して手作業で環境構築
  4. 担当システムの変更
  5. 再度、資材取得と手作業での環境構築

- After：**作業者や担当変更時も即対応可能**

  1. 作業者追加
  2. Docker + VSCode + DevContainers を準備
  3. 資材を Git から取得し、VSCode でコンテナ起動
  4. 担当システムの変更時も同様に再利用

## 懸念と向き合い方

1. セットアップ(wsl,vscode,git)
2. バージョン統一(git,vscode,wsl,docker)
3. Docker Desktop 使えない(vscode で OK)
4. Docker の学習コスト(将来的に必要なスキル)
5. コンテナ内から git push できない(耐える)
6. Windows は厳しい(VisualStudio で OK)
7. ネイティブアプリが厳しい(WindowsApp は VisualStudio で OK,MobileApp は厳しい)
8. 公式 image があるとは限らない

## まとめに回した方がいいか

| 観点                       | Before | After |
| -------------------------- | ------ | ----- |
| 作業者ごとの既存環境の影響 | 大     | 小    |
| トラブル発生率             | 高     | 低    |
| 本番環境との差異           | 大     | 小    |
| 不具合の発見速度           | 遅     | 早    |

| 観点                 | Before | After |
| -------------------- | ------ | ----- |
| 初回構築の作業量     | 多     | 少    |
| 環境変更の反映コスト | 高     | 低    |
| 作業者追加時の負担   | 大     | 小    |
| 属人化               | 高     | 低    |
